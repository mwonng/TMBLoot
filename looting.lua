local AddonName, Addon = ...

LootingTable = {
    ['Chestguard of the Fallen Hero'] = {
        [1] = 'Darkmalady',
        [2] = 'Legion'
    },
    ['Boots of Foretelling'] = {
        [1] = 'Blink',
        [2] = 'Lycoris',
        [3] = 'Magdevil',
        [4] = 'Naughtybaba',
        [5] = 'Prawnhub',
        [6] = 'Subzerolock',
        [7] = 'Kâywhy'
    },
    ['Adornment of Stolen Souls'] = {
        [1] = 'Blink',
        [2] = 'Darkmalady',
        [3] = 'Lycoris',
        [4] = 'Prawnhub',
        [5] = 'Tmmingtan',
        [6] = 'Kâywhy',
        [7] = 'Noi'
    },
    ['Malefic Girdle'] = {
        [1] = 'Kâywhy'
    },
    ['Wrynn Dynasty Greaves'] = {
        [1] = 'Lightswrath'
    },
    ['Justicar Pauldrons'] = {
        [1] = 'Exipaladin'
    },
    ['Jade Ring of the Everliving'] = {
        [1] = 'Azshånnå',
        [2] = 'Moisturise',
        [3] = 'Subzeroagent'
    },
    ['Saberclaw Talisman'] = {
        [1] = 'Sunnyflower'
    },
    ['Edgewalker Longboots'] = {
        [1] = 'Ist'
    },
    ['Tsunami Talisman'] = {
        [1] = 'Karrakaz'
    },
    ['Grips of Deftness'] = {
        [1] = 'Karrakaz',
        [2] = 'Granso',
        [3] = 'Tearess'
    },
    ['Light-Collar of the Incarnate'] = {
        [1] = 'Aemy',
        [2] = 'Yoku'
    },
    ['Blue Diamond Witchwand'] = {
        [1] = 'Azshånnå',
        [2] = 'Eborica',
        [3] = 'Moisturise'
    },
    ['Bladed Shoulderpads of the Merciless'] = {
        [1] = 'Xyy'
    },
    ['Anger-Spark Gloves'] = {
        [1] = 'Kâywhy'
    },
    ['Signet of Unshakable Faith'] = {
        [1] = 'Yoku'
    },
    ['Eye of Gruul'] = {
        [1] = 'Charlaminge',
        [2] = 'Eborica',
        [3] = 'Serephina',
        [4] = 'Moisturise',
        [5] = 'Yoku'
    },
    ['Fiend Slayer Boots'] = {
        [1] = 'Granso'
    },
    ['Gilded Thorium Cloak'] = {
        [1] = 'Triwhite',
        [2] = 'Xyy'
    },
    ['Aegis of the Vindicator'] = {
        [1] = 'Mvp',
        [2] = 'Exipaladin'
    },
    ['Magtheridon\'s Head'] = {
        [1] = 'Brion',
        [2] = 'Exipaladin',
        [3] = 'Sunnyflower',
        [4] = 'Triwhite'
    },
    ['Spiteblade'] = {
        [1] = 'Furieosa',
        [2] = 'Yatdou'
    },
    ['Mender\'s Heart-Ring'] = {
        [1] = 'Yoku'
    },
    ['Robe of the Elder Scribes'] = {
        [1] = 'Sombremoon'
    },
    ['Pantaloons of Repentance'] = {
        [1] = 'Moisturise',
        [2] = 'Yoku'
    },
    ['Pauldrons of the Fallen Defender'] = {
        [1] = 'Charlaminge',
        [2] = 'Triwhite'
    },
    ['Aldori Legacy Defender'] = {
        [1] = 'Gililib',
        [2] = 'Magelingz',
        [3] = 'Tearess',
        [4] = 'Feon',
        [5] = 'Sariella'
    },
    ['Boots of the Incorrupt'] = {
        [1] = 'Yoku'
    },
    ['Bands of Indwelling'] = {
        [1] = 'Yoku'
    },
    ['Light-Mantle of the Incarnate'] = {
        [1] = 'Aemy'
    },
    ['Shining Chain of the Afterworld'] = {
        [1] = 'Yoku'
    },
    ['Ruby Slippers'] = {
        [1] = 'Naughtybaba',
        [2] = 'Kâywhy',
        [3] = 'Sombremoon'
    },
    ['Uni-Mind Headdress'] = {
        [1] = 'Sombremoon'
    },
    ['Chestguard of the Conniver'] = {
        [1] = 'Yatdou'
    },
    ['Naaru Lightwarden\'s Band'] = {
        [1] = 'Aemy',
        [2] = 'Yoku'
    },
    ['Cyclone Faceguard'] = {
        [1] = 'Kâywhy'
    },
    ['Gauntlets of the Dragonslayer'] = {
        [1] = 'Kazami'
    },
    ['Stainless Cloak of the Pure Hearted'] = {
        [1] = 'Eborica',
        [2] = 'Moisturise',
        [3] = 'Subzeroagent'
    },
    ['Shermanar Great-Ring'] = {
        [1] = 'Xyy'
    },
    ['Trial-Fire Trousers'] = {
        [1] = 'Sombremoon'
    },
    ['Chestguard of the Fallen Champion'] = {
        [1] = 'Sariella'
    },
    ['Eye of Magtheridon'] = {
        [1] = 'Evilgenius',
        [2] = 'Feiyun',
        [3] = 'Legion',
        [4] = 'Magelingz',
        [5] = 'Naughtybaba',
        [6] = 'Sariella'
    },
    ['Girdle of the Endless Pit'] = {
        [1] = 'Granso',
        [2] = 'Furieosa'
    },
    ['King\'s Defender'] = {
        [1] = 'Gililib'
    },
    ['Bloodmaw Magus-Blade'] = {
        [1] = 'Blink',
        [2] = 'Darkmalady',
        [3] = 'Evilgenius',
        [4] = 'Fahrenheit',
        [5] = 'Gililib',
        [6] = 'Legion',
        [7] = 'Magdevil',
        [8] = 'Magelingz',
        [9] = 'Tmmingtan',
        [10] = 'Sariella'
    },
    ['Shard of the Virtuous'] = {
        [1] = 'Yoku'
    },
    ['Ritssyn\'s Lost Pendant'] = {
        [1] = 'Xikixiki'
    },
    ['Drape of the Dark Reavers'] = {
        [1] = 'Ist',
        [2] = 'Kazami',
        [3] = 'Tearess',
        [4] = 'Scotchribs'
    },
    ['Romulo\'s Poison Vial'] = {
        [1] = 'Xyy'
    },
    ['Sunfury Bow of the Phoenix'] = {
        [1] = 'Brion',
        [2] = 'Ioll',
        [3] = 'Jackeyhunter',
        [4] = 'Kazami',
        [5] = 'Márkus',
        [6] = 'Fivecmpersec',
        [7] = 'Meowzchaser',
        [8] = 'Scotchribs',
        [9] = 'Thørin'
    },
    ['Plans: Bracers of the Green Fortress'] = {
        [1] = 'Granso'
    },
    ['Nathrezim Mindblade'] = {
        [1] = 'Darkmalady',
        [2] = 'Evilgenius',
        [3] = 'Feiyun',
        [4] = 'Legion',
        [5] = 'Lycoris',
        [6] = 'Magdevil',
        [7] = 'Naughtybaba',
        [8] = 'Prawnhub',
        [9] = 'Subzerolock',
        [10] = 'Olddrymon',
        [11] = 'Xikixiki'
    },
    ['Leggings of the Fallen Defender'] = {
        [1] = 'Triwhite'
    },
    ['Vambraces of Courage'] = {
        [1] = 'Lightswrath',
        [2] = 'Mvp'
    },
    ['Ring of Recurrence'] = {
        [1] = 'Darkmalady',
        [2] = 'Lycoris',
        [3] = 'Kâywhy'
    },
    ['Helm of the Fallen Defender'] = {
        [1] = 'Triwhite'
    },
    ['Earthsoul Leggings'] = {
        [1] = 'Subzeroagent'
    },
    ['Mitts of the Treemender'] = {
        [1] = 'Subzeroagent'
    },
    ['Bladespire Warbands'] = {
        [1] = 'Granso',
        [2] = 'Furieosa',
        [3] = 'Feon'
    },
    ['Pauldrons of the Fallen Champion'] = {
        [1] = 'Mvp',
        [2] = 'Kâywhy'
    },
    ['Emberspur Talisman'] = {
        [1] = 'Azshånnå'
    },
    ['Ruby Drape of the Mysticant'] = {
        [1] = 'Blink',
        [2] = 'Darkmalady',
        [3] = 'Evilgenius',
        [4] = 'Magdevil',
        [5] = 'Naughtybaba',
        [6] = 'Subzerolock',
        [7] = 'Kâywhy',
        [8] = 'Noi',
        [9] = 'Olddrymon'
    },
    ['Eredar Wand of Obliteration'] = {
        [1] = 'Darkmalady',
        [2] = 'Serephina',
        [3] = 'Noi'
    },
    ['Cloak of the Pit Stalker'] = {
        [1] = 'Sonico'
    },
    ['Ribbon of Sacrifice'] = {
        [1] = 'Azshånnå',
        [2] = 'Charlaminge',
        [3] = 'Yoku'
    },
    ['Worgen Claw Necklace'] = {
        [1] = 'Scotchribs'
    },
    ['Malefic Mask of the Shadows'] = {
        [1] = 'Sonico'
    },
    ['Pit Lord\'s Satchel'] = {
        [1] = 'Sonico'
    },
    ['Leggings of the Fallen Champion'] = {
        [1] = 'Sariella'
    },
    ['Shadow-Cloak of Dalaran'] = {
        [1] = 'Sariella',
        [2] = 'Xikixiki'
    },
    ['Band of Crimson Fury'] = {
        [1] = 'Kâywhy'
    },
    ['Ring of Unrelenting Storms'] = {
        [1] = 'Kâywhy'
    },
    ['Tirisfal Wand of Ascendancy'] = {
        [1] = 'Blink',
        [2] = 'Darkmalady',
        [3] = 'Fahrenheit',
        [4] = 'Subzerolock',
        [5] = 'Noi'
    },
    ['Windshear Boots'] = {
        [1] = 'Kâywhy'
    },
    ['Girdle of the Prowler'] = {
        [1] = 'Granso'
    },
    ['Cyclone Handguards'] = {
        [1] = 'Kâywhy'
    },
    ['The Lightning Capacitor'] = {
        [1] = 'Kâywhy'
    },
    ['Gloves of the Fallen Champion'] = {
        [1] = 'Lightswrath'
    },
    ['Skulker\'s Greaves'] = {
        [1] = 'Granso',
        [2] = 'Jackeyhunter',
        [3] = 'Yatdou'
    },
    ['Helm of the Fallen Champion'] = {
        [1] = 'Lightswrath',
        [2] = 'Mvp',
        [3] = 'Yatdou'
    },
    ['Cyclone Shoulderguards'] = {
        [1] = 'Kâywhy'
    },
    ['Shuriken of Negation'] = {
        [1] = 'Feon'
    },
    ['Pauldrons of the Fallen Hero'] = {
        [1] = 'Darkmalady',
        [2] = 'Evilgenius',
        [3] = 'Legion',
        [4] = 'Olddrymon'
    },
    ['Justicar Chestpiece'] = {
        [1] = 'Exipaladin'
    },
    ['Brute Cloak of the Ogre-Magi'] = {
        [1] = 'Prawnhub',
        [2] = 'Subzerolock',
        [3] = 'Noi'
    },
    ['Chestguard of the Fallen Defender'] = {
        [1] = 'Charlaminge',
        [2] = 'Triwhite'
    },
    ['Iron Gauntlets of the Maiden'] = {
        [1] = 'Lightswrath'
    },
    ['Gloves of Saintly Blessings'] = {
        [1] = 'Azshånnå',
        [2] = 'Yoku'
    },
    ['Gloves of the Fallen Hero'] = {
        [1] = 'Darkmalady',
        [2] = 'Olddrymon'
    },
    ['Panzar\'Thar Breastplate'] = {
        [1] = 'Magelingz'
    },
    ['Belt of Divine Inspiration'] = {
        [1] = 'Lycoris',
        [2] = 'Kâywhy',
        [3] = 'Xikixiki'
    },
    ['Jewel of Infinite Possibilities'] = {
        [1] = 'Legion'
    },
    ['Brooch of Unquenchable Fury'] = {
        [1] = 'Legion',
        [2] = 'Naughtybaba',
        [3] = 'Subzerolock',
        [4] = 'Sombremoon'
    },
    ['Gronn-Stitched Girdle'] = {
        [1] = 'Brion',
        [2] = 'Jackeyhunter'
    },
    ['Robes of the Incarnate'] = {
        [1] = 'Aemy',
        [2] = 'Yoku'
    },
    ['Legacy'] = {
        [1] = 'Brion',
        [2] = 'Ioll',
        [3] = 'Kazami'
    },
    ['Terestian\'s Stranglestaff'] = {
        [1] = 'Triwhite',
        [2] = 'Xyy'
    },
    ['Ring of a Thousand Marks'] = {
        [1] = 'Granso',
        [2] = 'Ioll',
        [3] = 'Ist',
        [4] = 'Jackeyhunter',
        [5] = 'Scotchribs',
        [6] = 'Yatdou'
    },
    ['Handwraps of Flowing Thought'] = {
        [1] = 'Fahrenheit',
        [2] = 'Legion',
        [3] = 'Magdevil',
        [4] = 'Tmmingtan',
        [5] = 'Sombremoon',
        [6] = 'Xikixiki'
    },
    ['Moroes\' Lucky Pocket Watch'] = {
        [1] = 'Karrakaz',
        [2] = 'Gililib',
        [3] = 'Tearess',
        [4] = 'Sunnyflower',
        [5] = 'Xyy'
    },
    ['Garona\'s Signet Ring'] = {
        [1] = 'Ioll',
        [2] = 'Ist',
        [3] = 'Jackeyhunter',
        [4] = 'Kazami',
        [5] = 'Márkus',
        [6] = 'Scotchribs'
    },
    ['Gauntlets of Martial Perfection'] = {
        [1] = 'Granso',
        [2] = 'Furieosa',
        [3] = 'Feon'
    },
    ['Cyclone Legguards'] = {
        [1] = 'Kâywhy'
    },
    ['Barbed Choker of Discipline'] = {
        [1] = 'Gililib',
        [2] = 'Magelingz',
        [3] = 'Sunnyflower',
        [4] = 'Xyy'
    },
    ['Helm of the Fallen Hero'] = {
        [1] = 'Darkmalady',
        [2] = 'Legion'
    },
    ['Plans: Red Belt of Battle'] = {
        [1] = 'Granso'
    },
    ['Light\'s Justice'] = {
        [1] = 'Aemy',
        [2] = 'Azshånnå',
        [3] = 'Eborica',
        [4] = 'Mvp',
        [5] = 'Prawnhub',
        [6] = 'Exipaladin',
        [7] = 'Moisturise',
        [8] = 'Subzeroagent',
        [9] = 'Yoku'
    },
    ['Soul-Eater\'s Handwraps'] = {
        [1] = 'Fahrenheit',
        [2] = 'Lycoris',
        [3] = 'Prawnhub',
        [4] = 'Kâywhy',
        [5] = 'Noi'
    },
    ['Teeth of Gruul'] = {
        [1] = 'Aemy',
        [2] = 'Charlaminge',
        [3] = 'Eborica',
        [4] = 'Serephina',
        [5] = 'Exipaladin',
        [6] = 'Subzeroagent',
        [7] = 'Yoku'
    },
    ['Dragonspine Trophy'] = {
        [1] = 'Karrakaz',
        [2] = 'Brion',
        [3] = 'Furieosa',
        [4] = 'Ioll',
        [5] = 'Ist',
        [6] = 'Jackeyhunter',
        [7] = 'Kazami',
        [8] = 'Márkus',
        [9] = 'Riflemate',
        [10] = 'Shurrik',
        [11] = 'Tranimal',
        [12] = 'Feon',
        [13] = 'Fivecmpersec',
        [14] = 'Meowzchaser',
        [15] = 'Scotchribs',
        [16] = 'Sonico',
        [17] = 'Thørin',
        [18] = 'Triwhite',
        [19] = 'Yatdou'
    },
    ['Crystalheart Pulse-Staff'] = {
        [1] = 'Otherguy'
    },
    ['Crimson Girdle of the Indomitable'] = {
        [1] = 'Lightswrath',
        [2] = 'Gililib',
        [3] = 'Mvp'
    },
    ['The Hungering Cold'] = {
        [1] = 'Magwar'
    },
    ['Desecrated Gloves'] = {
        [1] = 'Magrate'
    },
    ['Blade of the Unrequited'] = {
        [1] = 'Brion',
        [2] = 'Ioll'
    },
    ["Wool Cloth"] = {
        [1] = 'Blink',
        [2] = 'Fy'
    },
    ["Linen Cloth"] = {
        [1] = 'Blink',
        [2] = 'Fy'
    }
}

-- local file = io.open('all-loot-export.csv');
-- transform data, reform by itemName
-- filtered by type
-- function transformByItemName(recordType)
--     local tableByItemName = {}
--     for line in io.lines('all-loot-export.csv') do -- load file name
--         local type, raid_group_name, member_name, character_name, character_class, character_is_alt,
--             character_inactive_at, character_note, sort_order, item_name, item_id, is_offspec, note, received_at,
--             import_id, item_note, item_prio_note, item_tier, item_tier_label, created_at, updated_at = line:match(
--             "%s*(.-),%s*(.-),%s*(.-),%s*(.-),%s*(.-),%s*(.-),%s*(.-),%s*(.-),%s*(.-),%s*(.-),%s*(.-),%s*(.-),%s*(.-),%s*(.-),%s*(.-),%s*(.-),%s*(.-),%s*(.-),%s*(.-),%s*(.-),%s*(.-)")
--         if (type == recordType and character_class ~= nil) then
--             itemNameWithoutDoubleQuote = string.gsub(item_name, '"', "")
--             if (tableByItemName[itemNameWithoutDoubleQuote] == nil) then
--                 tableByItemName[itemNameWithoutDoubleQuote] = {character_name}
--             else
--                 table.insert(tableByItemName[itemNameWithoutDoubleQuote], character_name)
--             end
--             -- print(character_name .. " " .. character_class .. " - " .. item_name)
--         end
--     end
--     return tableByItemName;
-- end

-- will return table of user:
-- { [1] = Blink,[2] = Darkmalady,}
function getListedUserByItemName(data, itemName)
    local item = data[itemName]
    local users = {}
    for e in pairs(item) do
        table.insert(users, item[e])
    end
    return users
end

function dump(o)
    if type(o) == 'table' then
        local s = '{ '
        for k, v in pairs(o) do
            if type(k) ~= 'number' then
                k = '"' .. k .. '"'
            end
            s = s .. '[' .. k .. '] = ' .. dump(v) .. ','
        end
        return s .. '} '
    else
        return tostring(o)
    end
end

Addon.lootingTable = LootingTable

